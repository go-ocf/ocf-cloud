<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="3279px" preserveAspectRatio="none" style="width:1548px;height:3279px;" version="1.1" viewBox="0 0 1548 3279" width="1548px" zoomAndPan="magnify"><defs><filter height="300%" id="fsfczgufddwbu" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#ADD8E6" height="3264.0078" style="stroke: #A80036; stroke-width: 1.0;" width="272.5" x="237" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="49" x="348.75" y="16.0669">Device</text><rect fill="#00BFFF" height="3264.0078" style="stroke: #A80036; stroke-width: 1.0;" width="629" x="750" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="67" x="1031" y="16.0669">plgd hub</text><rect fill="#FFFFFF" filter="url(#fsfczgufddwbu)" height="368.3984" style="stroke: #000000; stroke-width: 2.0;" width="644" x="88" y="272.9609"/><rect fill="#FFFFFF" height="322.1328" style="stroke: none; stroke-width: 1.0;" width="644" x="88" y="319.2266"/><rect fill="#FFFFFF" filter="url(#fsfczgufddwbu)" height="90.2031" style="stroke: #000000; stroke-width: 2.0;" width="569.5" x="400.5" y="808.1563"/><rect fill="#FFFFFF" height="43.9375" style="stroke: none; stroke-width: 1.0;" width="569.5" x="400.5" y="854.4219"/><rect fill="#FFFFFF" filter="url(#fsfczgufddwbu)" height="90.5313" style="stroke: #000000; stroke-width: 2.0;" width="782" x="744" y="1932.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="54" x2="54" y1="86.2969" y2="3181.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="164" x2="164" y1="86.2969" y2="3181.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="313" x2="313" y1="86.2969" y2="3181.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="457.5" x2="457.5" y1="86.2969" y2="3181.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="857" x2="857" y1="86.2969" y2="3181.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1272" x2="1272" y1="86.2969" y2="3181.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1450" x2="1450" y1="86.2969" y2="3181.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="21" y="82.9951">Operator</text><ellipse cx="54.5" cy="13" fill="#FEFECE" filter="url(#fsfczgufddwbu)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M54.5,21 L54.5,48 M41.5,29 L67.5,29 M54.5,48 L41.5,63 M54.5,48 L67.5,63 " fill="none" filter="url(#fsfczgufddwbu)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="21" y="3193.7061">Operator</text><ellipse cx="54.5" cy="3207.0078" fill="#FEFECE" filter="url(#fsfczgufddwbu)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M54.5,3215.0078 L54.5,3242.0078 M41.5,3223.0078 L67.5,3223.0078 M54.5,3242.0078 L41.5,3257.0078 M54.5,3242.0078 L67.5,3257.0078 " fill="none" filter="url(#fsfczgufddwbu)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fsfczgufddwbu)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="129" x="98" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="115" x="105" y="70.9951">Onboarding Tool</text><rect fill="#FEFECE" filter="url(#fsfczgufddwbu)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="129" x="98" y="3180.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="115" x="105" y="3200.7061">Onboarding Tool</text><rect fill="#FEFECE" filter="url(#fsfczgufddwbu)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="140" x="241" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="126" x="248" y="70.9951">Device Application</text><rect fill="#FEFECE" filter="url(#fsfczgufddwbu)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="140" x="241" y="3180.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="126" x="248" y="3200.7061">Device Application</text><rect fill="#FEFECE" filter="url(#fsfczgufddwbu)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="91" x="410.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="77" x="417.5" y="70.9951">DPS Library</text><rect fill="#FEFECE" filter="url(#fsfczgufddwbu)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="91" x="410.5" y="3180.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="77" x="417.5" y="3200.7061">DPS Library</text><rect fill="#FEFECE" filter="url(#fsfczgufddwbu)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="202" x="754" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="188" x="761" y="70.9951">Device Provisioning Service</text><rect fill="#FEFECE" filter="url(#fsfczgufddwbu)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="202" x="754" y="3180.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="188" x="761" y="3200.7061">Device Provisioning Service</text><rect fill="#FEFECE" filter="url(#fsfczgufddwbu)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="202" x="1169" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="188" x="1176" y="70.9951">Certificate Authority Service</text><rect fill="#FEFECE" filter="url(#fsfczgufddwbu)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="202" x="1169" y="3180.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="188" x="1176" y="3200.7061">Certificate Authority Service</text><rect fill="#FEFECE" filter="url(#fsfczgufddwbu)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="1385" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="113" x="1392" y="70.9951">OAuth2.0 Server</text><rect fill="#FEFECE" filter="url(#fsfczgufddwbu)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="1385" y="3180.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="113" x="1392" y="3200.7061">OAuth2.0 Server</text><path d="M199,101.2969 L199,141.2969 L423,141.2969 L423,111.2969 L413,101.2969 L199,101.2969 " fill="#FBFB77" filter="url(#fsfczgufddwbu)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M413,101.2969 L413,111.2969 L423,111.2969 L413,101.2969 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="203" x="205" y="118.3638">Unique manufacturer certificate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="205" y="133.4966">set during the production</text><rect fill="#EEEEEE" filter="url(#fsfczgufddwbu)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1533" x="3" y="171.1289"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1536" y1="171.1289" y2="171.1289"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1536" y1="174.1289" y2="174.1289"/><rect fill="#EEEEEE" filter="url(#fsfczgufddwbu)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="119" x="710" y="160.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="100" x="716" y="176.6294">Configuration</text><polygon fill="#A80036" points="845,210.8281,855,214.8281,845,218.8281,849,214.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="54.5" x2="851" y1="214.8281" y2="214.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="61.5" y="209.7622">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="177" x="74.5" y="209.7622">Configure Enrollment Group</text><rect fill="#EEEEEE" filter="url(#fsfczgufddwbu)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1533" x="3" y="243.3945"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1536" y1="243.3945" y2="243.3945"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1536" y1="246.3945" y2="246.3945"/><rect fill="#EEEEEE" filter="url(#fsfczgufddwbu)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="136" x="701.5" y="232.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="117" x="707.5" y="248.895">DPS Connection</text><path d="M88,272.9609 L152,272.9609 L152,279.9609 L142,289.9609 L88,289.9609 L88,272.9609 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="368.3984" style="stroke: #000000; stroke-width: 2.0;" width="644" x="88" y="272.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="103" y="286.0278">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="282" x="167" y="285.1714">[DPS Address set by the device - Call Home]</text><polygon fill="#A80036" points="446,307.2266,456,311.2266,446,315.2266,450,311.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="313" x2="452" y1="311.2266" y2="311.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="320" y="306.1606">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="333" y="306.1606">Set DPS address</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="88" x2="732" y1="320.2266" y2="320.2266"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="426" x="93" y="330.437">[DPS address configured by the tool running discovery - Multicast]</text><polygon fill="#A80036" points="446,351.1641,456,355.1641,446,359.1641,450,355.1641" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="164.5" x2="452" y1="355.1641" y2="355.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="171.5" y="350.0981">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="184.5" y="350.0981">Discover x.com.plgd.dps.conf</text><polygon fill="#A80036" points="175.5,380.2969,165.5,384.2969,175.5,388.2969,171.5,384.2969" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="169.5" x2="457" y1="384.2969" y2="384.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="181.5" y="379.231">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="63" x="194.5" y="379.231">Here I am</text><path d="M267,397.2969 L267,422.2969 L645,422.2969 L645,407.2969 L635,397.2969 L267,397.2969 " fill="#FBFB77" filter="url(#fsfczgufddwbu)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M635,397.2969 L635,407.2969 L645,407.2969 L635,397.2969 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="357" x="273" y="414.3638">Devices with the x.com.plgd.dps.conf resource will reply.</text><polygon fill="#A80036" points="446,448.5625,456,452.5625,446,456.5625,450,452.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="164.5" x2="452" y1="452.5625" y2="452.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="171.5" y="447.4966">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="184.5" y="447.4966">Own device</text><polygon fill="#A80036" points="175.5,477.6953,165.5,481.6953,175.5,485.6953,171.5,481.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="169.5" x2="457" y1="481.6953" y2="481.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="181.5" y="476.6294">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="198.5" y="476.6294"/><path d="M274,494.6953 L274,534.6953 L638,534.6953 L638,504.6953 L628,494.6953 L274,494.6953 " fill="#FBFB77" filter="url(#fsfczgufddwbu)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M628,494.6953 L628,504.6953 L638,504.6953 L628,494.6953 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="343" x="280" y="511.7622">The onboarding tool becomes the owner of the device</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="280" y="526.895">or already owns it.</text><polygon fill="#A80036" points="446,561.0938,456,565.0938,446,569.0938,450,565.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="164.5" x2="452" y1="565.0938" y2="565.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="171.5" y="560.0278">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="184.5" y="560.0278">Set DPS address</text><polygon fill="#A80036" points="175.5,590.2266,165.5,594.2266,175.5,598.2266,171.5,594.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="169.5" x2="457" y1="594.2266" y2="594.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="181.5" y="589.1606">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="198.5" y="589.1606"/><path d="M194,607.2266 L194,632.2266 L718,632.2266 L718,617.2266 L708,607.2266 L194,607.2266 " fill="#FBFB77" filter="url(#fsfczgufddwbu)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M708,607.2266 L708,617.2266 L718,617.2266 L708,607.2266 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="503" x="200" y="624.2935">When the device is disowned or factory reset, the DPS address is set to empty.</text><path d="M385,653.3594 L385,693.3594 L929,693.3594 L929,663.3594 L919,653.3594 L385,653.3594 " fill="#FBFB77" filter="url(#fsfczgufddwbu)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M919,653.3594 L919,663.3594 L929,663.3594 L919,653.3594 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="381" x="460.25" y="670.4263">The device is authenticated by the manufacturer certificate.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="460.25" y="685.5591">Expired certificate can be used if enabled.</text><polygon fill="#A80036" points="845,719.7578,855,723.7578,845,727.7578,849,723.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="458" x2="851" y1="723.7578" y2="723.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="465" y="718.6919">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="362" x="478" y="718.6919">Connect and authenticate using Manufacturer Certificate</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="857" x2="899" y1="766.5234" y2="766.5234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="899" x2="899" y1="766.5234" y2="779.5234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="858" x2="899" y1="779.5234" y2="779.5234"/><polygon fill="#A80036" points="868,775.5234,858,779.5234,868,783.5234,864,779.5234" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="864" y="761.4575">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="886" y="761.4575">Validate certificate</text><path d="M1017,736.7578 L1017,791.7578 L1287,791.7578 L1287,746.7578 L1277,736.7578 L1017,736.7578 " fill="#FBFB77" filter="url(#fsfczgufddwbu)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1277,736.7578 L1277,746.7578 L1287,746.7578 L1277,736.7578 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="1023" y="753.8247">Validation against Mfg CA</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="249" x="1023" y="768.9575">registered in the Enrollment Group and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="1023" y="784.0903">against the revocation list.</text><path d="M400.5,808.1563 L464.5,808.1563 L464.5,815.1563 L454.5,825.1563 L400.5,825.1563 L400.5,808.1563 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="90.2031" style="stroke: #000000; stroke-width: 2.0;" width="569.5" x="400.5" y="808.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="415.5" y="821.2231">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="42" x="479.5" y="820.3667">[Valid]</text><polygon fill="#A80036" points="469,842.4219,459,846.4219,469,850.4219,465,846.4219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="463" x2="856" y1="846.4219" y2="846.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="475" y="841.356">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="497" y="841.356">Connection established</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="400.5" x2="970" y1="855.4219" y2="855.4219"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="53" x="405.5" y="865.6323">[Invalid]</text><line style="stroke: #A80036; stroke-width: 2.0;" x1="464" x2="474" y1="885.3594" y2="895.3594"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="464" x2="474" y1="895.3594" y2="885.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="470" x2="856" y1="890.3594" y2="890.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="475" y="885.2935">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="497" y="885.2935">Close connection</text><rect fill="#EEEEEE" filter="url(#fsfczgufddwbu)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1533" x="3" y="925.9258"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1536" y1="925.9258" y2="925.9258"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1536" y1="928.9258" y2="928.9258"/><rect fill="#EEEEEE" filter="url(#fsfczgufddwbu)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="201" x="669" y="915.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="177" x="675" y="931.4263">Check available content</text><path d="M192,953.4922 L192,978.4922 L1118,978.4922 L1118,963.4922 L1108,953.4922 L192,953.4922 " fill="#FBFB77" filter="url(#fsfczgufddwbu)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1108,953.4922 L1108,963.4922 L1118,963.4922 L1108,953.4922 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="905" x="198" y="970.5591">Content available for the DPS library which is derived from the Enrollment Group configuration is used to drive the workflow of the provisioning.</text><polygon fill="#A80036" points="845,1004.7578,855,1008.7578,845,1012.7578,849,1008.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="458" x2="851" y1="1008.7578" y2="1008.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="465" y="1003.6919">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="487" y="1003.6919">Get available resources</text><polygon fill="#A80036" points="469,1033.8906,459,1037.8906,469,1041.8906,465,1037.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="463" x2="856" y1="1037.8906" y2="1037.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="475" y="1032.8247">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="232" x="497" y="1032.8247">Available provisioning flow resources</text><path d="M478,1050.8906 L478,1468.8906 L848,1468.8906 L848,1060.8906 L838,1050.8906 L478,1050.8906 " fill="#FBFB77" filter="url(#fsfczgufddwbu)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M838,1050.8906 L838,1060.8906 L848,1060.8906 L838,1050.8906 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="484" y="1067.9575">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="500" y="1083.0903">"if": [oic.if.r, oic.if.b]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="500" y="1098.2231">"links": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="516" y="1113.356">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="204" x="532" y="1128.4888">"href": "/api/v1/provisioning/acls"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="516" y="1143.6216">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="516" y="1158.7544">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="301" x="532" y="1173.8872">"href": "/api/v1/provisioning/cloud-configuration"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="516" y="1189.02">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="516" y="1204.1528">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="249" x="532" y="1219.2856">"href": "/api/v1/provisioning/credentials"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="516" y="1234.4185">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="516" y="1249.5513">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="294" x="532" y="1264.6841">"href": "/api/v1/provisioning/customResource1"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="516" y="1279.8169">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="516" y="1294.9497">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="532" y="1310.0825">"href": "/api/v1/provisioning/ownership"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="516" y="1325.2153">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="516" y="1340.3481">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="532" y="1355.481">"href": "/api/v1/provisioning/ownership"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="516" y="1370.6138">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="516" y="1385.7466">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="532" y="1400.8794">"href": "/x.plgd.dev/time"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="516" y="1416.0122">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="516" y="1431.145">...</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="500" y="1446.2778">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="484" y="1461.4106">}</text><rect fill="#EEEEEE" filter="url(#fsfczgufddwbu)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1533" x="3" y="1499.043"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1536" y1="1499.043" y2="1499.043"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1536" y1="1502.043" y2="1502.043"/><rect fill="#EEEEEE" filter="url(#fsfczgufddwbu)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="231" x="654" y="1488.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="207" x="660" y="1504.5435">Device time synchronization</text><polygon fill="#A80036" points="845,1553.875,855,1557.875,845,1561.875,849,1557.875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="458" x2="851" y1="1557.875" y2="1557.875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="465" y="1545.2427">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="487" y="1537.6763">Get current time</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="137" x="487" y="1552.8091">(GET x.plgd.dev/time)</text><polygon fill="#A80036" points="469,1583.0078,459,1587.0078,469,1591.0078,465,1587.0078" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="463" x2="856" y1="1587.0078" y2="1587.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="475" y="1581.9419">16</text><a href="https://github.com/iotivity/iotivity-lite/blob/master/api/plgd/x.plgd.dev.time.yaml#L65" target="_top" title="https://github.com/iotivity/iotivity-lite/blob/master/api/plgd/x.plgd.dev.time.yaml#L65" xlink:actuate="onRequest" xlink:href="https://github.com/iotivity/iotivity-lite/blob/master/api/plgd/x.plgd.dev.time.yaml#L65" xlink:show="new" xlink:title="https://github.com/iotivity/iotivity-lite/blob/master/api/plgd/x.plgd.dev.time.yaml#L65" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="81" x="497" y="1581.9419">Current time</text></a><line style="stroke: #A80036; stroke-width: 1.0;" x1="458" x2="500" y1="1616.1406" y2="1616.1406"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="500" x2="500" y1="1616.1406" y2="1629.1406"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="459" x2="500" y1="1629.1406" y2="1629.1406"/><polygon fill="#A80036" points="469,1625.1406,459,1629.1406,469,1633.1406,465,1629.1406" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="465" y="1611.0747">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="487" y="1611.0747">Apply time if out of sync</text><rect fill="#EEEEEE" filter="url(#fsfczgufddwbu)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1533" x="3" y="1657.707"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1536" y1="1657.707" y2="1657.707"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1536" y1="1660.707" y2="1660.707"/><rect fill="#EEEEEE" filter="url(#fsfczgufddwbu)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="156" x="691.5" y="1647.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="132" x="697.5" y="1663.2075">Device Ownership</text><polygon fill="#A80036" points="845,1712.5391,855,1716.5391,845,1720.5391,849,1716.5391" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="458" x2="851" y1="1716.5391" y2="1716.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="465" y="1703.9067">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="487" y="1696.3403">Get device ownerhip</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="487" y="1711.4731">(GET api/v1/provisioning/ownership)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="857" x2="899" y1="1745.6719" y2="1745.6719"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="899" x2="899" y1="1745.6719" y2="1758.6719"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="858" x2="899" y1="1758.6719" y2="1758.6719"/><polygon fill="#A80036" points="868,1754.6719,858,1758.6719,868,1762.6719,864,1758.6719" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="864" y="1740.606">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="330" x="886" y="1740.606">Set owner from the Enrollment Group for the device</text><polygon fill="#A80036" points="469,1783.8047,459,1787.8047,469,1791.8047,465,1787.8047" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="463" x2="856" y1="1787.8047" y2="1787.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="475" y="1782.7388">20</text><a href="https://github.com/openconnectivityfoundation/security/blob/master/swagger2.0/oic.sec.doxm.swagger.json#L160" target="_top" title="https://github.com/openconnectivityfoundation/security/blob/master/swagger2.0/oic.sec.doxm.swagger.json#L160" xlink:actuate="onRequest" xlink:href="https://github.com/openconnectivityfoundation/security/blob/master/swagger2.0/oic.sec.doxm.swagger.json#L160" xlink:show="new" xlink:title="https://github.com/openconnectivityfoundation/security/blob/master/swagger2.0/oic.sec.doxm.swagger.json#L160" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="195" x="497" y="1782.7388">Device Owner Transfer Method</text></a><line style="stroke: #A80036; stroke-width: 1.0;" x1="458" x2="500" y1="1816.9375" y2="1816.9375"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="500" x2="500" y1="1816.9375" y2="1829.9375"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="459" x2="500" y1="1829.9375" y2="1829.9375"/><polygon fill="#A80036" points="469,1825.9375,459,1829.9375,469,1833.9375,465,1829.9375" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="465" y="1811.8716">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="487" y="1811.8716">Apply Ownership</text><rect fill="#EEEEEE" filter="url(#fsfczgufddwbu)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1533" x="3" y="1858.5039"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1536" y1="1858.5039" y2="1858.5039"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1536" y1="1861.5039" y2="1861.5039"/><rect fill="#EEEEEE" filter="url(#fsfczgufddwbu)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="218" x="660.5" y="1847.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="199" x="666.5" y="1864.0044">Device Identity Credentials</text><polygon fill="#A80036" points="845,1913.3359,855,1917.3359,845,1921.3359,849,1917.3359" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="458" x2="851" y1="1917.3359" y2="1917.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="465" y="1904.7036">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="309" x="487" y="1897.1372">Sign Identity CSR and retrieve device credentials</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="240" x="487" y="1912.27">(POST api/v1/provisioning/credentials)</text><path d="M744,1932.3359 L808,1932.3359 L808,1939.3359 L798,1949.3359 L744,1949.3359 L744,1932.3359 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="90.5313" style="stroke: #000000; stroke-width: 2.0;" width="782" x="744" y="1932.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="759" y="1945.4028">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="150" x="823" y="1944.5464">[JWT token not cached]</text><polygon fill="#A80036" points="1438.5,1981.7344,1448.5,1985.7344,1438.5,1989.7344,1442.5,1985.7344" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="857" x2="1444.5" y1="1985.7344" y2="1985.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="864" y="1973.1021">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="886" y="1965.5356">Get token using client credential flow</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="265" x="886" y="1980.6685">with the owner from the dps configuration</text><polygon fill="#A80036" points="868,2010.8672,858,2014.8672,868,2018.8672,864,2014.8672" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="862" x2="1449.5" y1="2014.8672" y2="2014.8672"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="874" y="2009.8013">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="63" x="896" y="2009.8013">JWT Token</text><polygon fill="#A80036" points="1260,2047,1270,2051,1260,2055,1264,2051" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="857" x2="1266" y1="2051" y2="2051"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="864" y="2045.9341">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="886" y="2045.9341">Sign device's Identity CSR</text><polygon fill="#A80036" points="868,2076.1328,858,2080.1328,868,2084.1328,864,2080.1328" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="862" x2="1271" y1="2080.1328" y2="2080.1328"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="874" y="2075.0669">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="896" y="2075.0669">Identity Certificate and plgd hub CA</text><polygon fill="#A80036" points="469,2105.2656,459,2109.2656,469,2113.2656,465,2109.2656" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="463" x2="856" y1="2109.2656" y2="2109.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="475" y="2104.1997">27</text><a href="https://github.com/openconnectivityfoundation/security/blob/master/swagger2.0/oic.sec.cred.swagger.json#L439" target="_top" title="https://github.com/openconnectivityfoundation/security/blob/master/swagger2.0/oic.sec.cred.swagger.json#L439" xlink:actuate="onRequest" xlink:href="https://github.com/openconnectivityfoundation/security/blob/master/swagger2.0/oic.sec.cred.swagger.json#L439" xlink:show="new" xlink:title="https://github.com/openconnectivityfoundation/security/blob/master/swagger2.0/oic.sec.cred.swagger.json#L439" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="225" x="497" y="2104.1997">Identity Certificate and plgd hub CA</text></a><line style="stroke: #A80036; stroke-width: 1.0;" x1="458" x2="500" y1="2138.3984" y2="2138.3984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="500" x2="500" y1="2138.3984" y2="2151.3984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="459" x2="500" y1="2151.3984" y2="2151.3984"/><polygon fill="#A80036" points="469,2147.3984,459,2151.3984,469,2155.3984,465,2151.3984" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="465" y="2133.3325">28</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="487" y="2133.3325">Apply Identity Credentials</text><rect fill="#EEEEEE" filter="url(#fsfczgufddwbu)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1533" x="3" y="2179.9648"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1536" y1="2179.9648" y2="2179.9648"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1536" y1="2182.9648" y2="2182.9648"/><rect fill="#EEEEEE" filter="url(#fsfczgufddwbu)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="140" x="699.5" y="2169.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="121" x="705.5" y="2185.4653">Get Device ACLs</text><polygon fill="#A80036" points="845,2234.7969,855,2238.7969,845,2242.7969,849,2238.7969" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="458" x2="851" y1="2238.7969" y2="2238.7969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="465" y="2226.1646">29</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="487" y="2218.5981">Get device ACLs</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="186" x="487" y="2233.731">(GET api/v1/provisioning/acls)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="857" x2="899" y1="2283.0625" y2="2283.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="899" x2="899" y1="2283.0625" y2="2296.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="858" x2="899" y1="2296.0625" y2="2296.0625"/><polygon fill="#A80036" points="868,2292.0625,858,2296.0625,868,2300.0625,864,2296.0625" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="864" y="2270.4302">30</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="275" x="886" y="2262.8638">Retrieve custom entries, generate required</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="379" x="886" y="2277.9966">for plgd hub instance and owner from the Enrollment Group</text><polygon fill="#A80036" points="469,2321.1953,459,2325.1953,469,2329.1953,465,2325.1953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="463" x2="856" y1="2325.1953" y2="2325.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="475" y="2320.1294">31</text><a href="https://github.com/openconnectivityfoundation/security/blob/master/swagger2.0/oic.sec.acl2.swagger.json#L362" target="_top" title="https://github.com/openconnectivityfoundation/security/blob/master/swagger2.0/oic.sec.acl2.swagger.json#L362" xlink:actuate="onRequest" xlink:href="https://github.com/openconnectivityfoundation/security/blob/master/swagger2.0/oic.sec.acl2.swagger.json#L362" xlink:show="new" xlink:title="https://github.com/openconnectivityfoundation/security/blob/master/swagger2.0/oic.sec.acl2.swagger.json#L362" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="79" x="497" y="2320.1294">Device ACLs</text></a><line style="stroke: #A80036; stroke-width: 1.0;" x1="458" x2="500" y1="2354.3281" y2="2354.3281"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="500" x2="500" y1="2354.3281" y2="2367.3281"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="459" x2="500" y1="2367.3281" y2="2367.3281"/><polygon fill="#A80036" points="469,2363.3281,459,2367.3281,469,2371.3281,465,2367.3281" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="465" y="2349.2622">32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="71" x="487" y="2349.2622">Apply ACLs</text><rect fill="#EEEEEE" filter="url(#fsfczgufddwbu)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1533" x="3" y="2395.8945"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1536" y1="2395.8945" y2="2395.8945"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1536" y1="2398.8945" y2="2398.8945"/><rect fill="#EEEEEE" filter="url(#fsfczgufddwbu)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="220" x="659.5" y="2385.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="201" x="665.5" y="2401.395">Resource pre-configuration</text><polygon fill="#A80036" points="845,2450.7266,855,2454.7266,845,2458.7266,849,2454.7266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="458" x2="851" y1="2454.7266" y2="2454.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="465" y="2442.0942">33</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="352" x="487" y="2434.5278">Get pre-configuration specified in the Enrollment Group</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="247" x="487" y="2449.6606">(GET api/v1/provisioning/res?if=oic.if.b)</text><polygon fill="#A80036" points="469,2479.8594,459,2483.8594,469,2487.8594,465,2483.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="463" x2="856" y1="2483.8594" y2="2483.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="475" y="2478.7935">34</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="497" y="2478.7935">Resource content</text><path d="M480,2496.8594 L480,2748.8594 L848,2748.8594 L848,2506.8594 L838,2496.8594 L480,2496.8594 " fill="#FBFB77" filter="url(#fsfczgufddwbu)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M838,2496.8594 L838,2506.8594 L848,2506.8594 L838,2496.8594 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="486" y="2513.9263">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="502" y="2529.0591">"if": [oic.if.r, oic.if.b]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="502" y="2544.1919">"links": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="518" y="2559.3247">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="299" x="534" y="2574.4575">"href": "/api/v1/provisioning/custom/resource/1"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="534" y="2589.5903">"etag": "0",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="534" y="2604.7231">"rep": {...}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="518" y="2619.856">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="518" y="2634.9888">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="299" x="534" y="2650.1216">"href": "/api/v1/provisioning/custom/resource/2"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="534" y="2665.2544">"etag": "1",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="534" y="2680.3872">"rep": {...}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="518" y="2695.52">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="518" y="2710.6528">...</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="502" y="2725.7856">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="486" y="2740.9185">}</text><rect fill="#EEEEEE" filter="url(#fsfczgufddwbu)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1533" x="3" y="2778.5508"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1536" y1="2778.5508" y2="2778.5508"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1536" y1="2781.5508" y2="2781.5508"/><rect fill="#EEEEEE" filter="url(#fsfczgufddwbu)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="220" x="659.5" y="2767.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="201" x="665.5" y="2784.0513">Get plgd hub configuration</text><polygon fill="#A80036" points="845,2833.3828,855,2837.3828,845,2841.3828,849,2837.3828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="458" x2="851" y1="2837.3828" y2="2837.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="465" y="2824.7505">35</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="189" x="487" y="2817.1841">Get plgd hub connection data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="283" x="487" y="2832.3169">(GET api/v1/provisioning/cloud-configuration)</text><polygon fill="#A80036" points="1438.5,2877.6484,1448.5,2881.6484,1438.5,2885.6484,1442.5,2881.6484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="857" x2="1444.5" y1="2881.6484" y2="2881.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="864" y="2869.0161">36</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="886" y="2861.4497">Get token using client credential flow</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="240" x="886" y="2876.5825">with owner from the dps configuration</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="857" x2="899" y1="2925.9141" y2="2925.9141"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="899" x2="899" y1="2925.9141" y2="2938.9141"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="858" x2="899" y1="2938.9141" y2="2938.9141"/><polygon fill="#A80036" points="868,2934.9141,858,2938.9141,868,2942.9141,864,2938.9141" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="864" y="2913.2817">37</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="886" y="2905.7153">Get connection data of plgd hub</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="221" x="886" y="2920.8481">registered in the Enrollment Group</text><polygon fill="#A80036" points="469,2964.0469,459,2968.0469,469,2972.0469,465,2968.0469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="463" x2="856" y1="2968.0469" y2="2968.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="475" y="2962.981">38</text><a href="https://github.com/openconnectivityfoundation/cloud-services/blob/master/swagger2.0/oic.r.coapcloudconf.swagger.json#L215" target="_top" title="https://github.com/openconnectivityfoundation/cloud-services/blob/master/swagger2.0/oic.r.coapcloudconf.swagger.json#L215" xlink:actuate="onRequest" xlink:href="https://github.com/openconnectivityfoundation/cloud-services/blob/master/swagger2.0/oic.r.coapcloudconf.swagger.json#L215" xlink:show="new" xlink:title="https://github.com/openconnectivityfoundation/cloud-services/blob/master/swagger2.0/oic.r.coapcloudconf.swagger.json#L215" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="160" x="497" y="2962.981">Token &amp; connection data</text></a><line style="stroke: #A80036; stroke-width: 1.0;" x1="458" x2="500" y1="2997.1797" y2="2997.1797"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="500" x2="500" y1="2997.1797" y2="3010.1797"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="459" x2="500" y1="3010.1797" y2="3010.1797"/><polygon fill="#A80036" points="469,3006.1797,459,3010.1797,469,3014.1797,465,3010.1797" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="465" y="2992.1138">39</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="275" x="487" y="2992.1138">Provisioning device for plgd hub connection</text><line style="stroke: #A80036; stroke-width: 2.0;" x1="839" x2="849" y1="3034.3125" y2="3044.3125"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="839" x2="849" y1="3044.3125" y2="3034.3125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="458" x2="844" y1="3039.3125" y2="3039.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="465" y="3034.2466">40</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="487" y="3034.2466">Close connection</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="458" x2="500" y1="3068.4453" y2="3068.4453"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="500" x2="500" y1="3068.4453" y2="3081.4453"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="459" x2="500" y1="3081.4453" y2="3081.4453"/><polygon fill="#A80036" points="469,3077.4453,459,3081.4453,469,3085.4453,465,3081.4453" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="465" y="3063.3794">41</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="132" x="487" y="3063.3794">Start Cloud Manager</text><rect fill="#EEEEEE" filter="url(#fsfczgufddwbu)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1533" x="3" y="3110.0117"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1536" y1="3110.0117" y2="3110.0117"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1536" y1="3113.0117" y2="3113.0117"/><rect fill="#EEEEEE" filter="url(#fsfczgufddwbu)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="171" x="684" y="3099.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="152" x="690" y="3115.5122">plgd hub connection</text><path d="M8,3137.5781 L8,3162.5781 L1498,3162.5781 L1498,3147.5781 L1488,3137.5781 L8,3137.5781 " fill="#FBFB77" filter="url(#fsfczgufddwbu)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1488,3137.5781 L1488,3147.5781 L1498,3147.5781 L1488,3137.5781 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="317" x="571.5" y="3154.645">Flow continues in a standard way, as documented</text><a href="https://docs.plgd.dev/docs/architecture/component-overview/#hub-registration" target="_top" title="https://docs.plgd.dev/docs/architecture/component-overview/#hub-registration" xlink:actuate="onRequest" xlink:href="https://docs.plgd.dev/docs/architecture/component-overview/#hub-registration" xlink:show="new" xlink:title="https://docs.plgd.dev/docs/architecture/component-overview/#hub-registration" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="29" x="892.5" y="3154.645">here</text></a><!--MD5=[1e23177f37b9b688054efaf3e71c4065]
@startuml workflow
autonumber

actor Operator as op
participant "Onboarding Tool" as obt
box "Device" #LightBlue
participant "Device Application"  as device
participant "DPS Library" as dpc
end box
box "plgd hub" #DeepSkyBlue
participant "Device Provisioning Service" as dps
participant "Certificate Authority Service" as ca
end box
participant "OAuth2.0 Server" as os

note over of device
  Unique manufacturer certificate
  set during the production
end note
== Configuration ==
op -> dps: Configure Enrollment Group
== DPS Connection ==
alt DPS Address set by the device - Call Home
  device -> dpc: Set DPS address
else DPS address configured by the tool running discovery - Multicast
obt - -> dpc: Discover x.com.plgd.dps.conf
dpc -> obt: Here I am
note over dpc
  Devices with the x.com.plgd.dps.conf resource will reply.
end note
obt -> dpc: Own device
return
note over dpc
  The onboarding tool becomes the owner of the device
  or already owns it.
end note
obt -> dpc: Set DPS address
return
note over dpc
  When the device is disowned or factory reset, the DPS address is set to empty.
end note
end

note over dpc, dps
    The device is authenticated by the manufacturer certificate.
    Expired certificate can be used if enabled.
end note

dpc -> dps: Connect and authenticate using Manufacturer Certificate
dps -> dps: Validate certificate
note right
  Validation against Mfg CA
  registered in the Enrollment Group and
  against the revocation list.
end note
alt Valid
  dps -> dpc: Connection established
else Invalid
  dps ->x dpc: Close connection
end

== Check available content  ==
note over dpc, dps
  Content available for the DPS library which is derived from the Enrollment Group configuration is used to drive the workflow of the provisioning.
end note

dpc -> dps: Get available resources
dps -> dpc: Available provisioning flow resources
note left of dps
{
    "if": [oic.if.r, oic.if.b]
    "links": [
        {
            "href": "/api/v1/provisioning/acls"
        },
        {
            "href": "/api/v1/provisioning/cloud-configuration"
        },
        {
            "href": "/api/v1/provisioning/credentials"
        },
        {
            "href": "/api/v1/provisioning/customResource1"
        }
        {
            "href": "/api/v1/provisioning/ownership"
        },
        {
            "href": "/api/v1/provisioning/ownership"
        },
        {
            "href": "/x.plgd.dev/time"
        },
        ...
    ]
}
end note

== Device time synchronization  ==

dpc -> dps: Get current time\n(GET x.plgd.dev/time)
dps -> dpc: [[https://github.com/iotivity/iotivity-lite/blob/master/api/plgd/x.plgd.dev.time.yaml#L65 Current time]]
dpc -> dpc: Apply time if out of sync

== Device Ownership  ==

dpc -> dps: Get device ownerhip\n(GET api/v1/provisioning/ownership)
dps -> dps: Set owner from the Enrollment Group for the device
dps -> dpc: [[https://github.com/openconnectivityfoundation/security/blob/master/swagger2.0/oic.sec.doxm.swagger.json#L160 Device Owner Transfer Method]]
dpc -> dpc: Apply Ownership

== Device Identity Credentials ==

dpc -> dps : Sign Identity CSR and retrieve device credentials\n(POST api/v1/provisioning/credentials)
alt JWT token not cached
  dps -> os:Get token using client credential flow\nwith the owner from the dps configuration
  os -> dps: JWT Token
end
dps -> ca: Sign device's Identity CSR
ca -> dps: Identity Certificate and plgd hub CA
dps -> dpc: [[https://github.com/openconnectivityfoundation/security/blob/master/swagger2.0/oic.sec.cred.swagger.json#L439 Identity Certificate and plgd hub CA]]
dpc -> dpc: Apply Identity Credentials

== Get Device ACLs ==

dpc -> dps: Get device ACLs\n(GET api/v1/provisioning/acls)
dps -> dps: Retrieve custom entries, generate required \nfor plgd hub instance and owner from the Enrollment Group
dps -> dpc: [[https://github.com/openconnectivityfoundation/security/blob/master/swagger2.0/oic.sec.acl2.swagger.json#L362 Device ACLs]]
dpc -> dpc: Apply ACLs


== Resource pre-configuration ==

dpc -> dps: Get pre-configuration specified in the Enrollment Group\n(GET api/v1/provisioning/res?if=oic.if.b)
dps -> dpc: Resource content
note left of dps
{
    "if": [oic.if.r, oic.if.b]
    "links": [
        {
            "href": "/api/v1/provisioning/custom/resource/1"
            "etag": "0",
            "rep": {...}
        },
        {
            "href": "/api/v1/provisioning/custom/resource/2"
            "etag": "1",
            "rep": {...}
        },
        ...
    ]
}
end note

== Get plgd hub configuration ==
dpc -> dps : Get plgd hub connection data\n(GET api/v1/provisioning/cloud-configuration)
dps -> os: Get token using client credential flow\nwith owner from the dps configuration
dps -> dps: Get connection data of plgd hub\nregistered in the Enrollment Group
dps -> dpc: [[https://github.com/openconnectivityfoundation/cloud-services/blob/master/swagger2.0/oic.r.coapcloudconf.swagger.json#L215 Token & connection data]]
dpc -> dpc: Provisioning device for plgd hub connection
dpc ->x dps: Close connection
dpc -> dpc: Start Cloud Manager

== plgd hub connection ==
note across: Flow continues in a standard way, as documented [[https://docs.plgd.dev/docs/architecture/component-overview/#hub-registration here]]


@enduml

PlantUML version 1.2020.02(Sun Mar 01 11:22:07 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.24+8-post-Ubuntu-1ubuntu322.04
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>